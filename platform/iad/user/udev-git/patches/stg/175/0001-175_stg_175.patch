diff --git a/rules/rules.d/50-udev-default.rules b/rules/rules.d/50-udev-default.rules
index c47cdeceb1012d58b08b700df4a599a96f180060..12aede037964e8ac2a6d78f330b987fe5d39f52a 100644
--- a/rules/rules.d/50-udev-default.rules
+++ b/rules/rules.d/50-udev-default.rules
@@ -5,15 +5,9 @@ KERNEL=="tty[pqrstuvwxyzabcdef][0123456789abcdef]", GROUP="tty", MODE="0660"
 KERNEL=="ptmx",			GROUP="tty", MODE="0666"
 KERNEL=="tty",			GROUP="tty", MODE="0666"
 KERNEL=="tty[0-9]*",		GROUP="tty", MODE="0620"
-KERNEL=="vcs|vcs[0-9]*|vcsa|vcsa[0-9]*", GROUP="tty"
 
 # serial
 KERNEL=="tty[A-Z]*[0-9]|pppox[0-9]*|ircomm[0-9]*|noz[0-9]*|rfcomm[0-9]*", GROUP="dialout"
-KERNEL=="mwave",		GROUP="dialout"
-KERNEL=="hvc*|hvsi*",		GROUP="dialout"
-
-# virtio serial / console ports
-KERNEL=="vport*", ATTR{name}=="?*", SYMLINK+="virtio-ports/$attr{name}"
 
 # mem
 KERNEL=="null|zero|full|random|urandom", MODE="0666"
@@ -22,73 +16,35 @@ KERNEL=="mem|kmem|port|nvram",	GROUP="kmem", MODE="0640"
 # input
 SUBSYSTEM=="input", ENV{ID_INPUT}=="", IMPORT{builtin}="input_id"
 KERNEL=="mouse*|mice|event*",	MODE="0640"
-KERNEL=="ts[0-9]*|uinput",	MODE="0640"
-KERNEL=="js[0-9]*",		MODE="0644"
-
-# video4linux
-SUBSYSTEM=="video4linux",	GROUP="video"
-KERNEL=="vttuner*",		GROUP="video"
-KERNEL=="vtx*|vbi*",		GROUP="video"
-KERNEL=="winradio*",		GROUP="video"
-
-# graphics
-KERNEL=="agpgart",		GROUP="video"
-KERNEL=="pmu",			GROUP="video"
-KERNEL=="nvidia*|nvidiactl*",	GROUP="video"
-SUBSYSTEM=="graphics",		GROUP="video"
-SUBSYSTEM=="drm",		GROUP="video"
 
 # sound
 SUBSYSTEM=="sound",		GROUP="audio", \
   OPTIONS+="static_node=snd/seq", OPTIONS+="static_node=snd/timer"
 
-# DVB (video)
-SUBSYSTEM=="dvb", GROUP="video"
-
-# FireWire (firewire-core driver: IIDC devices, AV/C devices)
-SUBSYSTEM=="firewire", ATTR{units}=="*0x00a02d:0x00010*", GROUP="video"
-SUBSYSTEM=="firewire", ATTR{units}=="*0x00b09d:0x00010*", GROUP="video"
-SUBSYSTEM=="firewire", ATTR{units}=="*0x00a02d:0x010001*", GROUP="video"
-SUBSYSTEM=="firewire", ATTR{units}=="*0x00a02d:0x014001*", GROUP="video"
-
 # 'libusb' device nodes
 SUBSYSTEM=="usb", ENV{DEVTYPE}=="usb_device", MODE="0664"
 SUBSYSTEM=="usb", ENV{DEVTYPE}=="usb_device", IMPORT{builtin}="usb_id"
 
 # printer
-KERNEL=="parport[0-9]*",	GROUP="lp"
 SUBSYSTEM=="printer",		KERNEL=="lp*", GROUP="lp"
-SUBSYSTEM=="ppdev",		GROUP="lp"
 KERNEL=="lp[0-9]*",		GROUP="lp"
-KERNEL=="irlpt[0-9]*",		GROUP="lp"
 SUBSYSTEM=="usb", ENV{DEVTYPE}=="usb_device", ENV{ID_USB_INTERFACES}=="*:0701??:*", GROUP="lp"
 
 # block
 SUBSYSTEM=="block", GROUP="disk"
 
-# floppy
-SUBSYSTEM=="block", KERNEL=="fd[0-9]", GROUP="floppy"
-
 # cdrom
 SUBSYSTEM=="block", KERNEL=="sr[0-9]*", GROUP="cdrom"
 SUBSYSTEM=="scsi_generic", SUBSYSTEMS=="scsi", ATTRS{type}=="4|5", GROUP="cdrom"
-KERNEL=="pktcdvd[0-9]*", GROUP="cdrom"
-KERNEL=="pktcdvd", GROUP="cdrom"
 
 # tape
-KERNEL=="ht[0-9]*|nht[0-9]*", GROUP="tape"
-KERNEL=="pt[0-9]*|npt[0-9]*|pht[0-9]*", GROUP="tape"
 SUBSYSTEM=="scsi_generic|scsi_tape", SUBSYSTEMS=="scsi", ATTRS{type}=="1|8", GROUP="tape"
 
 # block-related
 KERNEL=="sch[0-9]*", GROUP="disk"
 SUBSYSTEM=="scsi_generic", SUBSYSTEMS=="scsi", ATTRS{type}=="0", GROUP="disk"
-KERNEL=="pg[0-9]*", GROUP="disk"
-KERNEL=="qft[0-9]*|nqft[0-9]*|zqft[0-9]*|nzqft[0-9]*|rawqft[0-9]*|nrawqft[0-9]*", GROUP="disk"
 KERNEL=="rawctl", GROUP="disk"
 SUBSYSTEM=="raw", KERNEL=="raw[0-9]*", GROUP="disk"
-SUBSYSTEM=="aoe", GROUP="disk", MODE="0220"
-SUBSYSTEM=="aoe", KERNEL=="err", MODE="0440"
 
 # network
 KERNEL=="tun",			MODE="0666", OPTIONS+="static_node=net/tun"
@@ -98,8 +54,3 @@ KERNEL=="rfkill",		MODE="0644"
 KERNEL=="cpu[0-9]*",		MODE="0444"
 
 KERNEL=="fuse", ACTION=="add",	MODE="0666", OPTIONS+="static_node=fuse"
-
-SUBSYSTEM=="rtc", DRIVERS=="rtc_cmos", SYMLINK+="rtc"
-KERNEL=="mmtimer",		MODE="0644"
-KERNEL=="rflash[0-9]*",		MODE="0400"
-KERNEL=="rrom[0-9]*",		MODE="0400"
diff --git a/udev/udev-builtin-input_id.c b/udev/udev-builtin-input_id.c
index 84ca0f75e4f4b2c8fa9470e397e1a5019bf8efcb..94a5b05ec9bf5277f6b8e738c0239ca80b331bc7 100644
--- a/udev/udev-builtin-input_id.c
+++ b/udev/udev-builtin-input_id.c
@@ -28,6 +28,8 @@
 #include <linux/limits.h>
 #include <linux/input.h>
 
+#define BTN_TRIGGER_HAPPY		0x2c0
+
 #include "udev.h"
 
 /* we must use this kernel-compatible implementation */
diff --git a/udev/udev-ctrl.c b/udev/udev-ctrl.c
index e4348c314d4b2632cf2e755072daee547aae608e..673216f02c460a2b12a9c38fe0901237eed3cc0a 100644
--- a/udev/udev-ctrl.c
+++ b/udev/udev-ctrl.c
@@ -15,6 +15,9 @@
 #include <stddef.h>
 #include <string.h>
 #include <unistd.h>
+#ifdef USE_ACCEPT_WORKAROUND
+#include <fcntl.h>
+#endif
 #include <sys/types.h>
 #include <sys/poll.h>
 #include <sys/socket.h>
@@ -182,6 +185,9 @@ struct udev_ctrl_connection *udev_ctrl_get_connection(struct udev_ctrl *uctrl)
 	struct ucred ucred;
 	socklen_t slen;
 	const int on = 1;
+#ifdef USE_ACCEPT_WORKAROUND
+	int flags;
+#endif
 
 	conn = calloc(1, sizeof(struct udev_ctrl_connection));
 	if (conn == NULL)
@@ -189,13 +195,23 @@ struct udev_ctrl_connection *udev_ctrl_get_connection(struct udev_ctrl *uctrl)
 	conn->refcount = 1;
 	conn->uctrl = uctrl;
 
+#ifdef USE_ACCEPT_WORKAROUND
+	conn->sock = accept(uctrl->sock, NULL, NULL);
+#else
 	conn->sock = accept4(uctrl->sock, NULL, NULL, SOCK_CLOEXEC|SOCK_NONBLOCK);
+#endif
 	if (conn->sock < 0) {
 		if (errno != EINTR)
-			err(uctrl->udev, "unable to receive ctrl connection: %m\n");
+			err(uctrl->udev, "unable to receive ctrl connection: %m - %s\n", strerror(errno));
 		goto err;
 	}
 
+#ifdef USE_ACCEPT_WORKAROUND
+	flags = fcntl(conn->sock, F_GETFL, NULL);
+	if (flags != -1)
+	    fcntl(conn->sock, F_SETFL, flags | O_NONBLOCK);
+	fcntl(conn->sock, F_SETFD, FD_CLOEXEC);
+#endif
 	/* check peer credential of connection */
 	slen = sizeof(ucred);
 	if (getsockopt(conn->sock, SOL_SOCKET, SO_PEERCRED, &ucred, &slen) < 0) {
